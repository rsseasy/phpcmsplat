function Validated(n){n&&(Validated.Item[n]=this)}Validated.Item={};Validated.prototype={rules:{},errmsg:"",addrule:function(n){for(var t in n)this.rules[t]=n[o];return this},remove:function(n){var t=this;n=n.split(",");$.each(n,function(n,i){t.rules[i]&&delete t.rules[i]})},refresh:function(){var n=this;$.each(this.rules,function(t){$("#"+t).length==0&&delete n.rules[t]})},validate:function(n,t){var t=t||$("#"+n).val()||$("#"+n).html().replace(/\s+/img,""),r=this.rules[n],i;if(r.required!==!1||t){i=r.data;switch(i.constructor){case RegExp:i=t.match(i);break;case Function:i=i(n)}return i&&this.rules[n].remote!==!1?this.succeed(n):this.error(n),i}return!0},bind:function(n,t){var i=this;return $.each(this.rules,function(r){var u=$("#"+r);u.length?(u.unbind(n,t),u.bind(n,t)):delete i[r]}),this},event:function(n,t){var i=this;this.rules[n]&&$("#"+n).bind(t,function(){i.validate(this.id)})},normal:function(n){var t=$("[for="+n+"]");return t.html(this.rules[n].normal||""),t.removeClass("succeed"),t.removeClass("error"),t.addClass("normal"),this},onsucceed:function(){},succeed:function(n){var t=$("[for="+n+"]");t.length&&(t[0].tagName.toLowerCase()!="input"&&t.html("&nbsp;"+(this.rules[n].complete||"")),t.removeClass("error"),t.removeClass("normal"),t.addClass("succeed"));this.rules[n].succeed=!0;this.onsucceed(n);return this},onerror:function(){},error:function(n,t){var i=$("[for="+n+"]");t=t||this.rules[n].remotemsg||this.rules[n].error||"出错了！";i.length?(this.infoval(i,t),i.removeClass("succeed"),i.removeClass("normal"),i.addClass("error"),this.rules[n].succeed=!1):alert(t);this.onerror(n,t);return this},remote:function(n,t,i){this.rules[n].remotemsg=i;switch(arguments.length){case 1:this.rules[n].remote=!1;break;case 2:this.rules[n].remote=t;break;case 3:t?(this.succeed(n),this.rules[n].remote=!0):this.error(n,i)}},infoval:function(n,t){n.addClass("normal");n[0].tagName.toLowerCase()=="input"?n.val(t||""):n.html(t||"")},initdef:function(){var n,t;for(n in this.rules)t=$("[for="+n+"]"),this.rules[n].def&&t.length&&this.infoval(t,this.rules[n].normal);return this},blur:function(){var n=this;return this.bind("blur",function(){n.validate(this.id)}),this},focus:function(){var n=this;return this.bind("focus",function(){n.normal(this.id)}),this},ajaxverify:function(n,t){var i=this;return t=t||"/data/ajaxverify.aspx",n=n||{},Cookie.Get("usertoken")&&(n.usertoken=Cookie.Get("usertoken")),$.post(t,n,function(n){if(n=n.toJson(),i.onajaxverify)i.onajaxverify(n);else i.remote(n.jsonmarker,n.data,errorcode[n.data])}),this},onajaxverify:null,complete:function(){var i,n,t;if(this.refresh(),i=arguments.length,i){for(n=0;n<i;n++)if(!this.validate(arguments[n])||this.rules[arguments[n]].remote===!1)return this.errmsg=this.rules[arguments[n]].error,!1}else for(t in this.rules)if(!this.validate(t)||this.rules[t].remote===!1)return this.errmsg=this.rules[t].error,!1;return this.oncomplete()},oncomplete:function(){return!0},trigger:function(n,t){var i=this;$(n).bind(t,function(n){i.complete()||n.preventDefault()})}};Validated.mailrule=/^[\w\.\-_]{1,20}@(?:[\w\-]{1,10}){1,3}(?:\.[\w\-]{1,10}){1,3}$/img;Validated.phonerule=/^1[1-9]\d{9}$/;Validated.fixedphonerule=/^\d{3,4}-?\d{7,8}-?\d{0,8}$/;Validated.qqrule=/^[1-9]\d{5,12}$/;Validated.idcardrule=/^\d{17,18}X?$/i;Validated.riqirule=/^\d{4}-?\d{2}-?\d{2}$/;Validated.photorule=/(jpg|png|jpeg)$/;Validated.pwdrule=/^.{6,}$/;Validated.Rules={};Validated.number=function(n,t,i){return n.constructor==Number&&n>=t&&n<=i};Validated.numberkey=function(n,t,i){var r=$("#"+n),t=r.attr("min")?parseFloat(r.attr("min")):t,i=r.attr("max")?parseFloat(r.attr("max")):i,u=parseFloat(r.val());return Validated.number(u,t,i)};Validated.money=function(n){return Validated.numberkey(n,-Math.pow(10,12)+1,Math.pow(10,12)-1)};Validated.tinyint=function(n){return Validated.numberkey(n,0,255)};Validated.smallint=function(n){return Validated.numberkey(n,-32768,32767)};Validated.int=function(n){return Validated.numberkey(n,-2147483648,2147483647)};Validated.bigint=function(n){return Validated.numberkey(n,-9223372036854775808,9223372036854775807)};Validated.float=function(n){var t=Math.pow(10,38);return Validated.numberkey(n,-t+1,t-1)};Validated.datetimekey=function(n,t,i){var r=$("#"+n),t=r.attr("min")||t,i=r.attr("max")||i,u=Date.parse(r.val());return Validated.number(u,Date.parse(t),Date.parse(i))};Validated.datetime=function(n){return Validated.datetimekey(n,"1700-01-01","9999-12-30")};Validated.string=function(n,t,i){return new RegExp("^.{"+t+","+i+"}$","img").test(n)};Validated.varcharkey=function(n,t,i){var r=$("#"+n),u=r.attr("minlength")||t,f=r.attr("maxlength")||i;return Validated.string(r.val(),u,f)};Validated.varchar=function(n){return Validated.varcharkey(n,0,4e3)};Validated.idcard=function(n){return $("#"+n).val().match(Validated.idcardrule)};$("[inputvalidate]").click(function(){var f=$(this),i=f.attr("inputvalidate"),r=$("#"+i),n;if(r.length){var t=r[0].elements,e=t.length,o=Validated[i],u=[];for(n=0;n<e;n++)t[n].id&&u.push(t[n].id);o.complete(u)}});$(document).ready(function(){$("[submitvalidate]").each(function(){var r=$(this),u=$(r.attr("submitvalidate")),t;if(u.length){var i=new Validated,f=u[0].elements,e=f.length,n=null;for(t=0;t<e;t++)n=f[t].id,Validated.Rules[n]&&(i.rules[n]=Validated.Rules[n]);i.focus().blur();i.trigger(r,"click")}})});var allowinput={};allowinput.number=function(n){var t=n.target.value;return n.which==189?!t.match(/^-[\d\.]*$/):n.which>47&&n.which<58||n.which>95&&n.which<106};allowinput.real=function(n){return n.which==110?!n.target.value.match(/\./img):this.number(n)||n.which==190};allowinput.money=function(n){return this.real(n)};allowinput.idcard=function(n){return this.number(n)||n.which==88};$("[allowinput]").each(function(){var n=$(this);n.keydown(function(t){return t.which==8||t.which==9||t.which==13||t.which==46||t.which>36&&t.which<41||allowinput[n.attr("allowinput")](t)})})